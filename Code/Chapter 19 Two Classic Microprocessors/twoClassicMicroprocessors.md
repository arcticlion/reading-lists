两种典型的微处理器
=================

微处理器——正是它，将计算机中央处理器的所有构成部件整合在一起，集成在一个硅芯片上——诞生于1971年。它的诞生有着很好的开端：第一个微处理器，即Intel 4004系列，包括了2300个晶体管。到现在，大约三十年过去了，家用计算机的微处理器中的晶体管数量也逐步逼近10 000 000个。

微处理器实际的作用基本上保持不变。现在的芯片上附加的上百万个晶体管可以做许多有趣的事情，但在微处理器最初的探索过程中，这些事情更多的是分散我们的注意力而不是给我们以启迪。为了对微处理器的工作情况获得更清晰的认识，让我们先看一下最初的微处理器。

### 8080微处理器

我们要讨论的微处理器出现于1974年。在该年度，Intel公司在4月推出了8080，Motorola（摩托罗拉）—从20世纪50年代开始生产半导体和晶体管产品的公司—在8月份推出了6800。它们并非是那年仅有的微处理器。同样是在1974年，德克萨斯仪器公司推出了4位的TMS1000，用在许多计算器、玩具和设备上；NationalSemiconductor（国家半导体公司）推出了PACE，它是第一个16位的微处理器。然而，回想起来，8080和6800是两个最具有重大历史意义的芯片。

Intel设定8080最初价格为$360，这是对IBMSystem/360的一个讽刺。IBMSystem/360是一个大型机系统，由许多大公司使用，要花费几百万美元。（今天，你只花$1.95就可以买到一个8080芯片。）这并不是说8080可以与System/360相提并论，但不用几年，IBM公司也将会正视这些很小的计算机。

8080是一个8位的微处理器，有6000个晶体管，时钟频率为2MHz，可寻址64KB的存储空间。6800（今天也只卖$1.95）有大约4000个晶体管，也可寻址64KB的存储空间。第1代6800的时钟频率为1MHz，但到1977年Motorola公司发布新款的6800时，其时钟频率已为1.5MHz和2MHz。

这些芯片被称为“单芯片微处理器”（single－chip microprocessors），不太准确的说法是“单芯片的计算机”。处理器只是计算机的一部分。除了处理器之外，计算机还需要其他一些设备，至少要包括一些随机访问的存储器（RAM）一些方便用户把信息输入计算机的设备（输入设备），一些使用户能够把信息从计算机中读取出来的设备（输出设备），以及其他一些能把所有构件连接在一起的芯片。本书会在第21章详细介绍这些构件。

现在，让我们来仔细研究一下微处理器本身。当描述微处理器的时候，我们总是习惯用一些框图来阐明其内部的构件及其连接情况。然而，在第17章我们已经使用了数不清的框图来描述它，现在我们将观察微处理器和外部设备的交互过程，以此来认识其内部的结构和工作原理。换句话说，为了弄清微处理器的工作原理，我们把它视作一个不需要详细研究其内部操作的黑盒。取而代之的方法是通过贯彻芯片的输入，输出型号，特别是芯片的指令集来理解微处理器的工作原理。

8080和6800都是40个管脚的集成电路。这些芯片最常见的IC封装大约为2英寸长，1/2英寸宽，1/8英寸厚。



当然，你看到的只是外包装。位于其内部的硅晶片非常小，就拿早期的8位微处理器来说，其硅晶片小于1/4平方英寸。外包装保护硅晶片并通过管脚提供对芯片的输入和输出点的访问。下图显示了8080的40个管脚的功能：



本书中我们所创建的所有电气或电子设备都需要某种电源供电。8080的一个特殊地方就是它需要三种电源电压：管教20必须接到5V的电压；管教11需要接到－5V的电压；管教28需要接到12V的电压；管脚2接地。（1976年，Intel发布了8085芯片，简化了这些电源需求）。

其他的管脚都标有箭头。从芯片引出的箭头表明这是一个输出（output）信号，这种信号由微处理器控制，计算机的其他芯片对该信号响应。指向芯片的箭头表明该信号是一个输入（input）信号，该信号由其他芯片发出，并由8080芯片对其响应。还一些管脚既是输入又是输出。

第17章所设计的处理器需要一个振荡器来使其工作。8080需要两个不同的同步时钟输入，它们的频率都是2MHz，分别标记为ø1和ø2，位于管脚22和15上。这些信号可以很方便地由Intel公司生产的8224时钟信号发生器提供。给这个芯片连上一个18MHz的石英晶体，剩下的工作它基本上可以完成。


一个微处理器通常有多个用来寻址存储器的输出信号。用于寻址的输出信号的数目与微处理器的可寻址空间大小直接相关。8080有16个用于寻址的输出信号，标记为A0～A15，因此它的可寻址空间大小为2的16次方，即65 536字节。

8080是一个8位的微处理器，可以一次从存储器读取或者向存储器写入8位数据。该芯片还包括标记为D0～D7的8个信号，这些信号是芯片仅有的几个既可以用做输入又可以用做输出的信号。当微处理器从存储器中读取一个字节时，这些管脚的功能是输入；当微处理器向存储器写入一个字节时，其功能又变成了输出。

芯片的其余10个管脚时控制信号（control signals）。例如，RESET（复位）输入用于控制微处理器的复位。输出信号1-WR的功能是指明微处理器需要向RAM中写入数据（1-WR信号对应于RAM阵列的写输入）。另外，当芯片读取指令时，其他控制信号会在某个时候出现在D0~D7管脚。由8080构成的计算机系统通常使用8228系统控制芯片来锁存这些附加的控制信号。后面将会讲述一些控制信号。由于8080的控制信号非常复杂，因此，除非你想基于8080芯片来实际设计计算机，否则最好不要用这些控制信号来折磨自己。

8080芯片复位后，它把锁存在存储器0000h地址处的字节读入微处理器，通过在地址信号端A0～A15输出16个0实现该过程。它读取的字节必须是8080指令，读取该字节的过程被称为取指令（instruction fetch）。

在第17章构造的计算机里，所有指令（除了停止指令HLT）都是3个字节长，包括一个操作码和两个字节的地址。在8080中，指令长度可以是1个字节、2个字节或3个字节。有些指令可使8080从存储器的某一位置处读出一个字节送到微处理器中；有些指令可使8080从微处理器中把数据写入存储器的某一位置处；其他指令可使8080不使用RAM而在内部执行。第一条指令执行完后，8080访问存储器中的第二条指令，依此类推。这些指令组合在一起构成一个计算机程序，用来完成一些自己感兴趣的事情。

当8080运行在最高速度即2MHz时，每个时钟周期为500纳秒（1除以2000000周等于0.000000500秒）。第17章中的每条指令都需要4个时钟周期，8080的每条指令则需要4～18个时钟周期，这意味着每条指令的执行时间为2～9微秒（即百万分之一秒）。


