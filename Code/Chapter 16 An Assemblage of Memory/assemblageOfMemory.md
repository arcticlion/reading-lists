储存器组织
==========

### 储存器与锁存器

人们总是将需要的记住的内容事先记起来，在需要时拿出来阅读；习惯于将可能用到的事物先存起来，在需要时将它们取出来。从技术角度来说，这个过程称为先存储后访问。存储器的职责和作用就在于此，它负责保障这两个过程之间信息完好无损。我们每次存储信息都要利用不同种类的存储器。比如，保存文本信息的不二之选就是纸张，而磁带则更适于储存音乐和电影。

电报继电器（Telegraph Relays）——以一定形式组织起来构成逻辑门，然后再形成触发器——同样具备保存信息的能力。在前面章节中我们讨论过，一个触发器可以对1位信息进行存储。这样的存储能力要存储一大堆的信息还远远不够，但它却为我们达到目标迈出了坚实的一步。其实知道了如何存储1位信息，很容易就可以想象出如何存储1位，3位或更多信息。

在第14章的学习过程中，我们一起讨论过由一个反向器，两个与门和两个或非门构成的D型电平触发器，如下图所示。




当时钟输入为1，Q端输出与数据端输入保持一致。但当时钟输入跳变为0时，Q端输出将保持数据端最后一次的输入。除非时钟输入再次还原为1，之后的数据端输入不会影响输出。此触发器的真值表如下。



在第14章的讨论中，这种触发器可以由两种不同特性的电路来实现，而在本章我们仅选择其中一种——目的就是为了保存1位信息。为了更清楚地表述，我们给输入和输出端重新命名，使其名称与功能相符，如下图所示。



从结构上来讲，这套电路与先前所学到的是同一种触发器，只是命名方式不尽相同，现在Q输出端被称为数据输出端（Data Out），时钟输入端（在第14章叫做保持位）命名为写操作端（Write）。就像信息可以被记录在纸上一样，写操作端的信号同样使得数据输入（Data In）信号被写入（Written Into），也可以称之为被存储（stored）到电路中。一般情况下，如果写操作端为0，则数据输入信号状态对输出无影响。而当我们想把数据输入信号存储在触发器中时，可以把写入信号应先置1后置为0.在第14章讲到过，这种类型的电路也被称为锁存器，因为存储进去的数据就好像被锁住一样。下面给出了1位锁存器简化框图，框图未画出其内部结构中的部件。



我们很容易想到如何把多个1位锁存器组织成为多位锁存器，所要做的就是把写操作端的信号连接到系统中，就像下面这样。



图中显示的8位锁存器其输入和输出端各有8个。另外还包括一个写操作端，在非工作状态下一般为0.如果把一个8位二进制数存储在锁存器中，首先要把写操作端置1，然后置0.我们同样可以把这个锁存器以框图的形式表现出来，就像下面这样。



为了和先前提到的1位锁存器保持一致，我们将它可以画成下面这种形式。



### 储存器

还有另一种方法集成8个1位锁存器，但其结构并不像上面的这样直观。假设我们只想用一个数据输入和输出信号端，而且希望锁存器能将输入信号数据分8次独立存储。最后一项要求就是我们还希望能够通过观察数据输出信号端确定实际的8位输出。

换句话说，在这种锁存器中我们只想存储8个单独的比特，而不是存储1个8位二进制数。

#### 8-1数据选择器

我们知道现在所需要的是8个1位锁存器。先不考虑数据如何存储在这些锁存器中，把重点放在如何用一个灯泡来确定锁存器的数据输出信号。最简单的方法就是把这个灯泡一次连接到锁存器上，分若干次来测试各个锁存器的输出，但是我们要追求更加自动化的方法。用关开选择想要检查的锁存器是一个好的办法。

究竟需要多少个开关能解决问题呢？我们可以把这个过程进一步抽象，问题变成了怎么样从8个物体选出一个我们想要的，我们需要3个开关。这是因为通过3个开关连通与闭合的排列组合，总共表示出8个不同的值：000，001，010，011，100，101，110，111.

现在我们手头上已有8个1位锁存器、3个开关、1个灯泡，此外在开关和灯泡之间还有另外一种装置，如下图所示。



这个“额外装置”就是图中的神秘盒子，顶部带有8个输入端，左侧也带有3个输入端。通过三个开关的闭合和断开，对顶部的输入进行8选1操作，输出结果被传递到其底部连接的灯泡，使其发光。

上图的这个装置我们称为8-1数据选择器（8－Line－to－1-Line Data Selector）。



8-1选择器有8个输入端（在其顶部），以及3个选择输入端（在其左侧）。选择输入端的功能就是选择一个输入端数据，然后使其在输出端输出。如果选择输入端为000，则将D0锁存器的值输出；若选择端为111，则D7锁存器的值将被输出；若选择端为101，则相应地输出D5的值。系统的真值表如下所示。



8-1选择器主要组成部件为：三个反向器，八个4端口输入与门，一个8端口输入或门，系统的组织结构如下图所示。



这个电路看上去线路密布，要理解它是如何工作的，最好方式就是一起来看一个例子。假设S2初始化为1，S1初始化为0，S0初始化为1.从顶部开始的第6个与门的输入由S0，1-S1，S2组成，初始状态下它们全为1.其余与门的这三项输入数据都与第6个与门不尽相同，这使得其余与门输出全部为0.若D5变为0意味着第6个与门输出为0；反之第6个与门输出则为1.对最右边的或门也可以按照同样的方式理解。我们可以总结出下面这个结论：若选择端为101，则数据输出端与D5的输出保持一致。

让我们重新整理一下思路，想想自己究竟要干什么。我们的目的是通过某种方式连接8个1位锁存器，使自己能够从一个输入信号端写入数据，还能从一个输出信号端鉴别出数据。现在我们已经成功地使用了一个8-1选择器对8个锁存器进行了选择操作，并将相应锁存器的数据输出，下面是电路的结构图。



#### 3-8译码器

到这里我们已经成功了一半。既然输出端已经满足了要求，现在把注意力集中到输入端。

输入端包括了数据输入信号及写操作信号。我们可以把所有数据输入信号在锁存器的输入端连接在一起。但8个写入信号是不可以连在一起的，因为我们很可能要向每个锁存器依次写入数据。除此之外还需要一个独立的写入信号，它能被路由到任意（且唯一）的锁存器上，系统的结构可用下图表示。



为了圆满完成任务，我们需要另外一款电路元件，而且这款元件与8-1选择器功能类似，但它的作用正好相反。我们所说的正是3-8译码器（3-to-8 Decoder）。前面的章节中我们曾学习过一个简易的数据译码器（Data Decoder）——在第11章中为了选择喜欢的猫咪的毛色，我们把开关以一定方式进行连接使其具有选择功能。

3-8译码器的输出端口共有8个。在任何时刻，译码器只会有一个锁存器的输出为1，其余均为0.每一个输出端的结果都是由S0，S1，S2这三个信号的排列组合决定的。而数据的输出和输入一致，如下图所示。



我再次强调一遍：注意从上往下数的第6个与门，它的输入包括S0，1-S1，S2.没有任何一个与门具有和它相同的三个输入。在这种情况下，如果选择输入端为101，则除了O5要根据情况进行判定外，其余与门输出都为0.这个时候，若数据端输入为0，则O5随之输出为0；相应的，若数据端输入为1，则O5输出为1.译码器的逻辑表可以如下表所示。



3-8译码器和8-1选择器简直一模一样，唯一的区别是3-8译码器的8个连接输出端的与门各多了一个数据输入端。

#### 随机访问存储器

将8个锁存器加入到电路就形成了完整的系统。



值得注意的是，译码器和选择器具有相同的选择信号，在上图中这三个信号一起被称为地址端口（Address）。地址的作用就像我们平时使用的邮箱号，长度为三位的地址决定了8个锁存器中的哪一个将被引用。在3-8译码器的输入端，地址起到了决定哪些锁存器可以被写操作端的信号触发来保存数据的作用。在输入端（图的下半部分），8-1选择器通过地址来选择8个锁存器的一个，最后将其输出。

这种配置下的锁存器在有的资料中也被称为读/写存储器（read/write memory), 但更普通的叫法是随机访问存储器（Random Access Memory），或RAM。可以认为我们讨论的这种存储器是可以存储8个独特比特的RAM，它的简化结构图如下所示。



上图所示的电路之所以能够称为存储器是因为它可以保存信息。而能够被称为读/写存储器是因为它不仅可以在每个锁存器中存储新的数据（可以把这种功能称为写数据），而且我们还可以检查每个锁存器都保存了什么数据（可以把这种功能称为读数据）。之所以可以被称为随机访问存储器，是因为读写操作很自由，我们只需要改变地址及相关的输入，就可以从8个锁存器中读出或写入需要的数据。相比其他的顺序型的存储器——这种存储器在使用时有一定的限制，如果想要读取地址为101的数据，必须先把地址为100的数据读取出来。


